<html><body>
<h1>AltRMI HelloWorld Demo</h1>
<center>By Paul Hammant</center>

<p>This demo reuses the Helloworld component, and retrofits remote capability.
It does this with the autopublisher tool from the Cornerstone project.</p>
<h2>Autopublishing</h2>
<p>The following shows how the HelloWorld demo block depends on ConnectionManager
from cornerstone. These two blocks packaged as a server application (.SAR file)
are loaded and launched by Phoenix, itself sitting on top of Avalon's framework.</p>
<h2>Relevant source modules</h2>
<p>The HelloWorld demo compiles as part of the build process for cornerstone.
The important modules that contribute to the demo are listed here.  All are within
the src directory</p>
<ol>
<li><b>org.apache.avalon.apps.demos.altrmihelloworldserver package</b>
This package contains the Java source the testing block.</li>
<li><b>conf\avalon-altrmidemo-assembly.xml</b> This contains the assembly
instructions for the resulting server archive (sar) file.</li>
<li><b>conf\avalon-altrmidemo-config.xml</b> This contains the configuration
for the resulting server archive (sar) file.</li>
</ol>

<h2>AltrmiHelloWorldServerTester.java - Java Source</h2>
<p>This forms part of an executable jar that allows you to remotely change
the HelloWorld demo block.</p>
<h2>avalon-altrmidemo-assembly xml</h2>
<p>The file is renamed as part of the build process to assembly.xml, and
only has a separate name here to aid development.  The bulk of the contents
of the file pertain to other blocks including the HelloWorld one.  Here's
the section that's for autopublishing</p>
<pre>
(text snipped)
  &lt;listener class="org.apache.altrmi.blocks.autopublishing.AutoPublisher"
                  name="altrmification-listener"/&gt;

  &lt;block class="org.apache.altrmi.blocks.authentication.DefaultAuthenticator"
         name="altrmi-authenticator" &gt;
  &lt;/block&gt;

  &lt;block class="org.apache.altrmi.blocks.publishing.SocketStreamPublisher"
         name="altrmi-publisher" &gt;
    &lt;provide name="sockets" role="org.apache.avalon.cornerstone.services.sockets.SocketManager"/&gt;
    &lt;provide name="connections"
	 role="org.apache.avalon.cornerstone.services.connection.ConnectionManager" /&gt;
    &lt;provide name="altrmi-authenticator" role="org.apache.altrmi.server.Authenticator"/&gt;
  &lt;/block&gt;
(text snipped)
</pre>
<p>Autopublisher needs an authenicator (the default), and a publisher
(SocketStreamPublisher).</p>
<h2>avalon-demo-config xml</h2>
<p>The file is renamed as part of the build process to config.xml, and only has a separate
name here to aid development.  Again here is the pertinent section:</p>
<pre>
(text snipped)
  &lt;altrmi-publisher&gt;
      &lt;port&gt;8666&lt;/port&gt;
      &lt;bind&gt;127.0.0.1&lt;/bind&gt;
      &lt;socketObjectStreamHandler&gt;
        &lt;connectiontimeout&gt;360000&lt;/connectiontimeout&gt;
      &lt;/socketObjectStreamHandler&gt;
      &lt;classRetrieverType&gt;jarFile&lt;/classRetrieverType&gt;
      &lt;socketStreamServerClass&gt;org.apache.altrmi.server.impl.socket.PartialSocketObjectStreamServer&lt;/socketStreamServerClass&gt;
      &lt;generatedClassJarURLs&gt;./HelloWorldAltrmiProxy.jar&lt;/generatedClassJarURLs&gt;
  &lt;/altrmi-publisher&gt;

  &lt;altrmi-authenticator&gt;
  &lt;/altrmi-authenticator&gt;

  &lt;altrmification-listener&gt;

    &lt;publisher&gt;altrmi-publisher&lt;/publisher&gt;

    &lt;publish block="helloworldserver"
      interfaceToPublish="org.apache.avalon.apps.demos.helloworldserver.HelloWorldServer"
      publishAsName="helloworld"/&gt;

  &lt;/altrmification-listener&gt;
(text snipped)
</pre>
<p>The autopublisher and publisher configuration are here.</p>
</body></html>
