<?xml version="1.0"?>

<document>
  <header>
    <title>Reference - The BlockInfo Specification</title>
    <version>3.0</version>

      <person id="PD" name="Peter Donald" email="peter@apache.org"/>

    <abstract>
      Specifies the format of BlockInfo files and the reasons for particular aspects.
    </abstract>
  </header>
  <body>
    <section name="Block Metadata">
      <p>
        The meta-data about each block is stored in a BlockInfo file. The info
        includes details on what version the block is, what <code>Service</code>s
        it depends upon and which <code>Service</code>s it can offer to other Blocks.
        In the future the info will also store such data as the schema for configuring
        the block.
      </p>

      <p>
        The BlockInfo file has the same name as the Block except with the extention
        <code>.xinfo</code>. Thus if you were looking up the meta info for a block named
        <code>com.biz.cornerstone.blocks.MyBlock</code> you would look up the resource
        <code>com/biz/cornerstone/blocks/MyBlock.xinfo</code> in the same block jar file that
        the block was packaged in. The BlockInfo file is a simple XML format. An
        example of such a file follows.
      </p>

      <source>
<![CDATA[
<?xml version="1.0"?>

<blockinfo>

  <block>
    <version>1.2.3</version>
  </block>

  <services>
    <service name="com.biz.cornerstone.services.MyService"
             version="2.1.3" />
  </services>

  <dependencies>
    <dependency>
      <role>com.biz.cornerstone.services.Authorizer</role>
      <service name="com.biz.cornerstone.service.Authorizer"
               version="1.0"/>
    </dependency>
    <dependency>
      <!-- note that role is not specified and defaults
           to name of service -->
      <service name="com.biz.cornerstone.service.RoleMapper"
               version="1.0"/>
    </dependency>
  </dependencies>

</blockinfo>

]]>
      </source>
      <p>
        You will notice that the information in the BlockInfo file is separated into
        three main sections; <code>block</code>, <code>services</code> and
        <code>dependencies</code>.
      </p>
      <s2 title="BlockInfo 'block' Section">
        <p>The block section specifies the version of class. In the future this
        section will also specify the configuration schema if the block is
        <code>Configurable</code>.</p>
      </s2>
      <s2 title="BlockInfo 'services' Section">
        <p>The services section documents the services that this block can offer other
        Blocks. The service instances indicate an interface and a version. The interface
        MUST extend <code>org.apache.phoenix.Service</code>. This section is optional
        and a Block can choose to not offer any services.</p>
      </s2>
      <s2 title="BlockInfo 'dependencies' Section">
        <p>The services section documents the services that this block requires to operate.
        Required services are placed in the Blocks ComponentManager under the name
        specified by the <code>role</code> element of dependency. As is documented in the
        <a href="@FRAMEWORK_BASE@/guide-cop-in-avalon.html">components</a> section, the
        concept of Role is more than just a behavioural contract. A <code>Service</code> is
        a behavioural contract and thus the necessity to support the role element. In most
        cases however the role element and the name attribute of the service will be
        identical. In these cases it is sufficient to just specify service element and role
        will default to name of service.</p>
      </s2>
    </section>
  </body>
</document>
