<?xml version="1.0" encoding="ISO-8859-1"?>
<!DOCTYPE document PUBLIC "-//APACHE//DTD Documentation V1.1//EN" "document-v11.dtd">
<document>
  <header>
    <title>The BlockInfo Specification</title>
    
  <authors><person name="Peter Donald" email="peter at apache.org"/></authors></header>
  <body>
    <section><title>Block Metadata</title>
      <p>
        The meta-data about each block is stored in a BlockInfo file. The info
        includes details on what version the block is, what <code>Service</code>s
        it depends upon and which <code>Service</code>s it can offer to other Blocks.
        In the future the info will also store such data as the schema for configuring
        the block.
      </p>

      <p>
        The BlockInfo file has the same name as the Block except with the extention
        <code>.xinfo</code>. Thus if you were looking up the meta info for a block named
        <code>com.biz.cornerstone.blocks.MyBlock</code> you would look up the resource
        <code>com/biz/cornerstone/blocks/MyBlock.xinfo</code> in the same block jar file that
        the block was packaged in. The BlockInfo file is a simple XML format. An
        example of such a file follows.
      </p>

      <source>

&lt;?xml version="1.0"?&gt;

&lt;blockinfo&gt;

  &lt;block&gt;
    &lt;version&gt;1.2.3&lt;/version&gt;
  &lt;/block&gt;

  &lt;services&gt;
    &lt;service name="com.biz.cornerstone.services.MyService"
             version="2.1.3" /&gt;
  &lt;/services&gt;

  &lt;dependencies&gt;
    &lt;dependency&gt;
      &lt;role&gt;com.biz.cornerstone.services.Authorizer&lt;/role&gt;
      &lt;service name="com.biz.cornerstone.service.Authorizer"
               version="1.2"/&gt;
    &lt;/dependency&gt;
    &lt;dependency&gt;
      &lt;!-- note that role is not specified and defaults
           to name of service. The service version is not
           specified and it defaults to "1.0" --&gt;
      &lt;service name="com.biz.cornerstone.service.RoleMapper"/&gt;
    &lt;/dependency&gt;
  &lt;/dependencies&gt;

&lt;/blockinfo&gt;


      </source>
      <p>
        You will notice that the information in the BlockInfo file is separated into
        three main sections; <code>block</code>, <code>services</code> and
        <code>dependencies</code>.
      </p>
      <section><title>BlockInfo 'block' Section</title>
        <p>The block section specifies the version of class. In the future this
        section will also specify the configuration schema if the block is
        <code>Configurable</code>.</p>
      </section>
      <section><title>BlockInfo 'services' Section</title>
        <p>The services section documents the services that this block can offer other
        Blocks. The service instances indicate an interface and optionally a version
        (defaults to version 1.0 if not specified). This section is optional and a Block
        can choose to not offer any services.</p>
      </section>
      <section><title>BlockInfo 'dependencies' Section</title>
        <p>The services section documents the services that this block requires to operate.
        Required services are placed in the Blocks ServiceManager under the name
        specified by the <code>role</code> element of dependency. As is documented in the
        <link href="http://jakarta.apache.org/avalon/framework/guide-cop-in-avalon.html">components</link> section, the
        concept of Role is more than just a behavioural contract. A <code>Service</code> is
        a behavioural contract and thus the necessity to support the role element. In most
        cases however the role element and the name attribute of the service will be
        identical. In these cases it is sufficient to just specify service element and role
        will default to name of service.</p>
      </section>
    </section>
  </body>
</document>
