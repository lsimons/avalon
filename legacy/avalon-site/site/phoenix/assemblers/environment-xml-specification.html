<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<META http-equiv="Content-Type" content="text/html; charset=UTF-8">
<!--*** This is a generated file.  Do not edit.  ***-->
<link rel="stylesheet" href="../skin/tigris.css" type="text/css">
<link rel="stylesheet" href="../skin/mysite.css" type="text/css">
<link rel="stylesheet" href="../skin/site.css" type="text/css">
<link media="print" rel="stylesheet" href="../skin/print.css" type="text/css">
<title>Specification of environment.xml</title>
</head>
<body bgcolor="white" class="composite">
<!--================= start Banner ==================-->
<div id="banner">
<table width="100%" cellpadding="8" cellspacing="0" summary="banner" border="0">
<tbody>
<tr>
<!--================= start Group Logo ==================-->
<td align="left">
<div class="groupLogo">
<a href="http://avalon.apache.org/"><img border="0" class="logoImage" alt="Apache Avalon-Phoenix" src="../images/apache-avalon-logo.png"></a>
</div>
</td>
<!--================= end Group Logo ==================-->
<!--================= start Project Logo ==================--><td align="right">
<div class="projectLogo">
<a href="http://apachecon.com/2003/US/index.html"><img border="0" class="logoImage" alt="Visit ApacheCon 2003!" src="http://www.apache.org/~ceki/ac2003/ac2003-150.gif"></a>
</div>
</td>
<!--================= end Project Logo ==================-->
</tr>
</tbody>
</table>
</div>
<!--================= end Banner ==================-->
<!--================= start Main ==================-->
<table width="100%" cellpadding="0" cellspacing="0" border="0" summary="nav" id="breadcrumbs">
<tbody>
<!--================= start Status ==================-->
<tr class="status">
<td>
<!--================= start BreadCrumb ==================--><a href="http://www.apache.org/">Apache Main</a> | <a href="http://avalon.apache.org/">Avalon Main</a> | <a href="../">Up</a>
<!--================= end BreadCrumb ==================--></td><td id="tabs">
<!--================= start Tabs ==================-->
<div class="tab">
<span class="unselectedTab"><a href="http://www.apache.org/">Apache</a></span> | <span class="unselectedTab"><a href="http://avalon.apache.org/">Avalon</a></span> | <span class="unselectedTab"><a href="http://avalon.apache.org/product/framework/">Framework</a></span> | <span class="unselectedTab"><a href="http://avalon.apache.org/product/containers/">Containers</a></span> | <span class="unselectedTab"><a href="http://avalon.apache.org/product/components/">Components</a></span>
</div>
<!--================= end Tabs ==================-->
</td>
</tr>
</tbody>
</table>
<!--================= end Status ==================-->
<table id="main" width="100%" cellpadding="8" cellspacing="0" summary="" border="0">
<tbody>
<tr valign="top">
<!--================= start Menu ==================-->
<td id="leftcol">
<div id="navcolumn">
<div class="menuBar">
<div class="menu">
<span class="menuLabel">Essentials</span>

<div class="menuItem">
<a href="../index.html">Overview</a>
</div>

<div class="menuItem">
<a href="../features.html">Features</a>
</div>

<div class="menuItem">
<a href="../getting-started.html">Getting started</a>
</div>

<div class="menuItem">
<a href="http://avalon.apache.org/bindownload.cgi">Download</a>
</div>

<div class="menuItem">
<a href="../install.html">Install</a>
</div>

</div>
<div class="menu">
<span class="menuLabel">Guide</span>

<div class="menuItem">
<a href="../guide-architecture.html">Architectural Overview</a>
</div>

<div class="menuItem">
<a href="../guide-roles.html">Development Roles</a>
</div>

<div class="menuItem">
<a href="../guide-administrator.html">for Administrators</a>
</div>

<div class="menuItem">
<a href="../guide-deployers.html">for Deployers</a>
</div>

<div class="menuItem">
<a href="../assemblers/index.html">for Assemblers</a>
</div>

<div class="menuItem">
<a href="../bdg/index.html">for Block Developers</a>
</div>

<div class="menuItem">
<a href="../mx/index.html">Management Guide</a>
</div>

<div class="menuItem">
<a href="../guide-example-configuration.html">Example configuration</a>
</div>

<div class="menuItem">
<a href="../guide-punit.html">PUnit unit testing</a>
</div>

</div>
<div class="menu">
<span class="menuLabel">Reference</span>

<div class="menuItem">
<a href="../api/index.html">API Docs</a>
</div>

<div class="menuItem">
<a href="../assemblers/config-xml-specification.html">config.xml Specification</a>
</div>

<div class="menuItem">
<a href="../assemblers/assembly-xml-specification.html">assembly.xml Specification</a>
</div>

<div class="menuItem">
<span class="menuSelected">environment.xml Specification</span>
</div>

<div class="menuItem">
<a href="../bdg/blockinfo-specification.html">BlockInfo Specification</a>
</div>

</div>
<div class="menu">
<span class="menuLabel">For Developers</span>

<div class="menuItem">
<a href="../changes.html">Changes</a>
</div>

<div class="menuItem">
<a href="http://avalon.apache.org/code-standards.html">Coding standards</a>
</div>

<div class="menuItem">
<a href="../for-developers-project-structure.html">Project Structure</a>
</div>

<div class="menuItem">
<a href="http://jakarta.apache.org/site/cvsindex.html">CVS Repositories</a>
</div>

<div class="menuItem">
<a href="http://jakarta.apache.org/site/mail.html">Mailing Lists</a>
</div>

<div class="menuItem">
<a href="http://nagoya.apache.org/bugzilla/buglist.cgi?bug_status=UNCONFIRMED&bug_status=NEW&bug_status=ASSIGNED&bug_status=REOPENED&bug_status=RESOLVED&product=Avalon&component=Phoenix">TODO</a>
</div>

<div class="menuItem">
<a href="http://jira.werken.com/secure/BrowseProject.jspa?id=10081">Issue Tracker (Bug and Enhancement List)</a>
</div>

<div class="menuItem">
<a href="../for-developers-alternate-kernel.html">Alternate Kernels</a>
</div>

</div>
</div>
</div>
</td>
<!--================= end Menu ==================-->
<!--================= start Content ==================--><td>
<div id="bodycol">
<div class="app">
<div align="center">
<h1>Specification of environment.xml</h1>
</div>
<div class="h3">
  
  
    
<div class="h3">
<h3>Introduction</h3>
</div>
      
<p>
        The purpose of the <span class="codefrag">environment.xml</span> file is to configure environmental
        or Server Application wide settings. Currently this means being able to set the
        security policy and configure logging settings. A sample <span class="codefrag">environment.xml</span>
        follows. Previously thread pool settings were also configured in this
        section but this has been deprecated. Note that previously the information stored in
        <span class="codefrag">environment.xml</span> was stored in a file named <span class="codefrag">server.xml</span>.
      </p>
    
    
<div class="h3">
<h3>Sample environment.xml file</h3>
</div>
      
<pre class="code">
&lt;?xml version="1.0"?&gt;

&lt;environment&gt;

    &lt;logs&gt;
      &lt;category name="" target="default" priority="DEBUG" /&gt;
      &lt;category name="myAuthorizer" target="myAuthorizer-target"
                priority="DEBUG" /&gt;

      &lt;log-target name="default"
                  location="/logs/default.log" /&gt;
      &lt;log-target name="myAuthorizer-target"
                  location="/logs/authorizer.log" /&gt;
    &lt;/logs&gt;

    &lt;policy&gt;
      &lt;keystore name="foo-keystore"
                location="sar:/conf/keystore"
                type="JKS" /&gt;

      &lt;grant code-base="file:${app.home}${/}some-dir${/}*"
              key-store="foo-keystore" &gt;
        &lt;permission class="java.io.FilePermission"
                    target="${/}tmp${/}*"
                    action="read,write" /&gt;
      &lt;/grant&gt;

      &lt;grant signed-by="Bob"
             code-base="sar:/SAR-INF/lib/*"
             key-store="foo-keystore" &gt;
        &lt;permission class="java.io.FilePermission"
                    target="${/}tmp${/}*"
                    action="read,write" /&gt;
      &lt;/grant&gt;
    &lt;/policy&gt;

&lt;/environment&gt;

      </pre>
      
<p>
        The format of the policy section should be largely self evident if the assembler
        has experience with standard policy files. It should be noted that if no
        policy section is given then the Server Application runs at full permissions.
        The evaluation of properties occurs in a similar manner to standard
        policy file property expansion. There are a number of extra properties that
        will be evaluated. These include; <span class="codefrag">app.home</span> and <span class="codefrag">app.name</span>.
      </p>
      
<p>
        One special thing to not is that the user can use URLs of the form,
        "sar:/SAR-INF/lib/*". This will apply the permissions to the jars
        contained in the .SAR file. Note that these urls must start with
        "sar:/" and must use the "/" character as file separator, regardless
        of current operating system.
      </p>
      
<p>
        The logs section can currently have two types of elements; <em>log-target</em>s
        which represent destinations for logging and <em>category</em>s. There must be a
        log-target with the name "default". Categories are hierarchial in nature, have a
        priority and are associated with one or more log-targets. See the logging
        documentation for a further description of this section.
      </p>
      
<p>
        There is another type of log configuration. It is more configurable.
        Specify version attribute with logs elements. See javadoc of
        org.apache.avalon.excalibur.logger package for detailed description.
        Below is example configuration.
      </p>
      
<pre class="code">
&lt;?xml version="1.0"?&gt;
&lt;environment&gt;
  &lt;logs version="1.1"&gt;
    &lt;factories&gt;
      &lt;factory type="file" class="org.apache.avalon.excalibur.logger.factory.FileTargetFactory"/&gt;
    &lt;/factories&gt;

    &lt;categories&gt;
      &lt;category name="" log-level="INFO"&gt;
        &lt;log-target id-ref="default"/&gt;
      &lt;/category&gt;
    &lt;/categories&gt;

    &lt;targets&gt;
      &lt;file id="default"&gt;
        &lt;filename&gt;${app.home}/logs/default-&lt;/filename&gt;
        &lt;append&gt;true&lt;/append&gt;
        &lt;rotation type="unique" pattern="yyyyMMdd" suffix=".log"&gt;
          &lt;date&gt;yyyyMMdd&lt;/date&gt;
        &lt;/rotation&gt;
      &lt;/file&gt;
    &lt;/targets&gt;
  &lt;/logs&gt;
&lt;/environment&gt;
      </pre>
    
  

<div id="authors" align="right">by&nbsp;Peter Donald</div>
</div>
</div>
</div>
</td>
<!--================= end Content ==================-->
</tr>
</tbody>
</table>
<!--================= end Main ==================-->
<!--================= start Footer ==================-->
<div id="footer">
<table summary="footer" cellspacing="0" cellpadding="4" width="100%" border="0">
<tbody>
<tr>
<!--================= start Copyright ==================-->
<td colspan="2">
<div align="center">
<div class="copyright">
              Copyright &copy; 2002-2003&nbsp;The Apache Software Foundation.. All rights reserved.
            </div>
</div>
</td>
<!--================= end Copyright ==================-->
</tr>
<tr>
<td align="left">
<!--================= start Host ==================-->
<!--================= end Host ==================--></td><td align="right">
<!--================= start Credits ==================-->
<div align="right">
<div class="credit"></div>
</div>
<!--================= end Credits ==================-->
</td>
</tr>
</tbody>
</table>
</div>
<!--================= end Footer ==================-->
</body>
</html>
