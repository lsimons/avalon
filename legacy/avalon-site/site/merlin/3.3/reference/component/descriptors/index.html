
  

  
  

  
  

  

  
  

  
  

  
  

  

  

  

  

  

  
  
  
  
      
  

      
      
      
      
      
      
        
         
      
      

      
      
      
      

      
      
      

      

  
  

  
  

   
   


    
	
	

    
    
      
	
	
	<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

    <html>
      <head>
        
        
          <title>
            Merlin - 
          Component Specification
        
          </title>
        
        
        
        <style type="text/css">
          @import url("../../../style/tigris.css");
          @import url("../../../style/maven.css");
        </style>
        
        
        
        
        
        <link rel="stylesheet" href="../../../style/print.css" type="text/css" media="print"></link>
        <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1"></meta>
        
          <meta name="author" content="Stephen McConnell"></meta>
          <meta name="email" content="mcconnell@apache.org"></meta>
        
        
        
        
      </head>

      <body class="composite">

        <div id="banner">
          <table height="103" border="0" width="100%" cellpadding="8" cellspacing="0">
            <tr>
              
              <td>
                
                
                  
                  
                  
                    
                  
                  
                  
                  
                  
                  <a href="http://avalon.apache.org/">
                    <img border="0" alt="The Apache Software Foundation" src="http://avalon.apache.org/images/apache-avalon-logo.png" align="left"></img>
                  </a>
                
              </td>

              <td></td>
              

            </tr>
          </table>
        </div>
        <div id="breadcrumbs">
          <table border="0" width="100%" cellpadding="4" cellspacing="0">
            <tr>
              
              <td>
                <div align="right">
                  
                  
                  
                    
    
    
      
      
      
      <a href="http://apache.org/">Apache</a>
      
    
      |
      
      
      <a href="http://avalon.apache.org/">Avalon</a>
      
    
      |
      
      
      <a href="http://avalon.apache.org/product/framework/">Framework</a>
      
    
      |
      
      
      <a href="http://avalon.apache.org/product/containers/">Containment</a>
      
    
      |
      
      
      <a href="http://avalon.apache.org/product/components/">Components</a>
      
    
  
                  
                  
                </div>
              </td>
            </tr>
          </table>
        </div>
        
        <table border="0" width="100%" cellpadding="8" cellspacing="0"> 
          <tr valign="top">
            <td width="20%" id="leftcol">
              <div id="navcolumn">
                

                
                  
    <div>
      <strong>About Merlin</strong>
      
    
    
    
    

    <div>
      <small>
      	
      	
      		<a href="../../../about/index.html">Overview</a>
      	
      </small>
	  
        
      
    </div>
  
    
    
    
    

    <div>
      <small>
      	
      	
      		<a href="../../../starting/index.html">Getting Started</a>
      	
      </small>
	  
        
      
    </div>
  
    
    
    
    

    <div>
      <small>
      	
      	
      		<a href="../../../merlin/index.html">Merlin System</a>
      	
      </small>
	  
        
      
    </div>
  
    
    
    
    

    <div>
      <small>
      	
      	
      		<a href="../../../meta/index.html">Meta Model</a>
      	
      </small>
	  
        
      
    </div>
  
    
    
    
    

    <div>
      <small>
      	
      	
      		<a href="../../../tools/index.html">Tools</a>
      	
      </small>
	  
        
      
    </div>
  
    
    
    
    

    <div>
      <small>
      	
      	
      		<a href="../../../extensions/index.html">Extensions</a>
      	
      </small>
	  
        
      
    </div>
  
    </div>
  
    <div>
      <strong>Resources</strong>
      
    
    
    
    

    <div>
      <small>
      	
      	
      		<a href="../../../api/index.html">Javadoc</a>
      	
      </small>
	  
        
      
    </div>
  
    
    
    
    

    <div>
      <small>
      	
      	
      		<a href="../../../reference/index.html">Specification</a>
      	
      </small>
	  
        
    
    
    
    

    <div>
      <small>
      	
      	
      		<a href="../../../reference/component/index.html">Component Specification</a>
      	
      </small>
	  
        
    
    
    
    

    <div>
      <small>
      	
      		<b><a href="../../../reference/component/descriptors/index.html">Descriptors</a></b>
      	
      	
      </small>
	  
        
    
    
    
    

    <div>
      <small>
      	
      	
      		<a href="../../../reference/component/descriptors/index.html#Javadoc Tag Markup">Javadoc Tags</a>
      	
      </small>
	  
        
      
    </div>
  
    
    
    
    

    <div>
      <small>
      	
      	
      		<a href="../../../reference/component/descriptors/index.html#XML External Form">External Form</a>
      	
      </small>
	  
        
      
    </div>
  
    
    
    
    

    <div>
      <small>
      	
      	
      		<a href="../../../reference/component/descriptors/index.html#Type Model">Type Model</a>
      	
      </small>
	  
        
      
    </div>
  
      
    </div>
  
    
    
    
    

    <div>
      <small>
      	
      	
      		<a href="../../../reference/component/artifacts/index.html">Artifacts</a>
      	
      </small>
	  
        
      
    </div>
  
    
    
    
    

    <div>
      <small>
      	
      	
      		<a href="../../../reference/component/lifecycle/index.html">Lifecycle</a>
      	
      </small>
	  
        
      
    </div>
  
    
    
    
    

    <div>
      <small>
      	
      	
      		<a href="../../../reference/component/lifestyle/index.html">Lifestyle</a>
      	
      </small>
	  
        
      
    </div>
  
      
    </div>
  
    
    
    
    

    <div>
      <small>
      	
      	
      		<a href="../../../reference/deployment/index.html">Deployment Specification</a>
      	
      </small>
	  
        
      
    </div>
  
    
    
    
    

    <div>
      <small>
      	
      	
      		<a href="../../../reference/system/index.html">System Specification</a>
      	
      </small>
	  
        
      
    </div>
  
      
    </div>
  
    
    
    
    

    <div>
      <small>
      	
      	
      		<a href="../../../resources/download.html">Download</a>
      	
      </small>
	  
        
      
    </div>
  
    
    
    
    

    <div>
      <small>
      	
      	
      		<a href="../../../resources/roadmap/index.html">Roadmap</a>
      	
      </small>
	  
        
      
    </div>
  
    
    
    
    

    <div>
      <small>
      	
      	
      		<a href="../../../dpml/index.html">DPML</a>
      	
      </small>
	  
        
      
    </div>
  
    </div>
  
    <div>
      <strong>Related Projects</strong>
      
    
    
    
    

    <div>
      <small>
      	
      	
      		<a href="http://avalon.apache.org/meta">Meta</a>
      	
      </small>
	  
        
      
    </div>
  
    
    
    
    

    <div>
      <small>
      	
      	
      		<a href="http://avalon.apache.org/util">Utilities</a>
      	
      </small>
	  
        
      
    </div>
  
    
    
    
    

    <div>
      <small>
      	
      	
      		<a href="http://avalon.apache.org/repository">Repository</a>
      	
      </small>
	  
        
      
    </div>
  
    </div>
  
                
                
                
                

                
                
                <div>
                  <strong>Project Documentation</strong>
                  
                  <div>
                    <small>
                      <a href="../../../project-info.html">Project Info</a>
                    </small>
                    
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                  </div>
                  <div>
                    <small>
                      <a href="../../../maven-reports.html">Project Reports</a>
                    </small>
                    
					
                    
                    
                    
                    
                    
                  </div>
                  
                  
                </div>
              
              
                
                
                
                
              
                
              </div>
            </td>
            <td rowspan="2">
              <div id="bodycol">
                
                <div class="app">
                  
                  
    <div class="h3">
      
      
        <h3>
          <a name="Component Descriptors">Component Descriptors</a>
        </h3>
      
      
    <p>
      
Within the COP (Component Oriented Programming) domain there is a principal that the component is supplied with the resources its needs in order to function properly.  The direct implication of this principal is that a component should declare exactly what it needs.  When we consider a portable and reusable component we need to think its deployment dependecies, structural dependencies, context assumptions, configuration and parameterization criteria, throught to minor details such the logging channels that the component implementation assumes.
      
    </p>
   
    <p>
      
This information is captured in a object called a Type.  An instance of Type describes the component and can be used by a container without necessarily loading the component class.  Instance of Type are created from an XML external form.  The XML descriptor can be created manually or more typically through development tools that automate the creation process based on javadoc tags included in the source code.
      
    </p>
   
    </div>
  
    <div class="h3">
      
      
        <h3>
          <a name="Specifications">Specifications</a>
        </h3>
      
      
    <div class="h4">
      
      
        <h4>
          <a name="Javadoc Tag Markup">Javadoc Tag Markup</a>
        </h4>
      
      
    <p>
      
Information about a component type may be declared in the form of javadoc tags (refer 
    <a href="http://avalon.apache.org/meta/tools/tags/index.html">Tag Specification</a>
  .  Using 
    <a href="http://avalon.apache.org/meta/tools/index.html">development tools</a>
   supplied as part of the 
    <a href="http://avalon.apache.org/meta/index.html">Avalon Meta</a>
   package - the process of generation of an XML type descriptor can be completely automated.  
        
    </p>
   
    <p>
      
A special tag @avalon.component is used to identify a class as a component.  The following code framgment illustrates the use of the @avalon.component tag.
        
    </p>
   
    <div id="source">
      <pre>
/**
 * Component demonstrating access to standard context entries.
 *
 * @avalon.component name="demo" lifestyle="singleton"
 */
public class HelloComponent 
{
   ...
}
</pre>
    </div>
  
    <p>
      
Additional tags are used to markup requirements that a component class has towards a container.  In the following code fragment a constructor is presented with a series of context entry dependencies that the component has during its instantiation phase. Each tag represents a particular context entry assumption that the component has, and the implicit responsibility of a container to fulfill.
        
    </p>
   
    <div id="source">
      <pre>
   /**
    * Creation of a new HelloComponent instance using a 
    * container supplied logging channel and context.
    * The context supplied by the container holds the 
    * standard context entries for the home and 
    * working directories, component name and partition.
    *
    * @avalon.entry key="urn:avalon:name" 
    * @avalon.entry key="urn:avalon:partition" 
    * @avalon.entry key="urn:avalon:home" type="java.io.File"
    * @avalon.entry key="urn:avalon:temp" type="java.io.File"
    */
    public HelloComponent( Logger logger, Context context )
      throws ContextException
    {
        m_logger = logger;

        m_home = (File) context.get( "urn:avalon:home" );
        m_temp = (File) context.get( "urn:avalon:temp" );
        m_name = (String) context.get( "urn:avalon:name" );
        m_partition = (String) context.get( "urn:avalon:partition" );

        StringBuffer buffer = new StringBuffer( "standard context entries" );
        buffer.append( "\n  name: " + m_name );
        buffer.append( "\n  home: " + m_home );
        buffer.append( "\n  temp: " + m_temp );
        buffer.append( "\n  partition: " + m_partition );

        m_logger.info( buffer.toString() );
    }
</pre>
    </div>
  
    </div>
  
    <div class="h4">
      
      
        <h4>
          <a name="XML External Form">XML External Form</a>
        </h4>
      
      
    <p>
      
A component type may be associated with a component class by colocating an XML file with the suffix "xinfo" with the component implementation class.  For example, the class tutorial.Hello is packaged in a jar file under the path /tutorial/Hello.class.  The xinfo file is packaged as /tutorial/Hello.xinfo.
        
    </p>
   
    <p>
      
The formal specification of the 
    <a href="http://avalon.apache.org/meta/meta/info/index.html">XML external form</a>
   for component type descriptors is available as part of the 
    <a href="http://avalon.apache.org/meta/index.html">Avalon Meta Package</a>
  .
        
    </p>
   
    <p>
      
An example of a xinfo XML content taken from the context casting tutorial is presented below.
        
    </p>
   
    <div id="source">
      <pre>
&lt;type&gt;
  &lt;info&gt;
    &lt;name&gt;demo&lt;/name&gt;
    &lt;version&gt;1.0.0&lt;/version&gt;
    &lt;lifestyle&gt;singleton&lt;/lifestyle&gt;
    &lt;collection&gt;hard&lt;/collection&gt;
  &lt;/info&gt;
  &lt;context type="tutorial.DemoContext"&gt;
    &lt;entry key="urn:avalon:name" /&gt;
    &lt;entry key="urn:avalon:partition" /&gt;
    &lt;entry key="urn:avalon:home" type="java.io.File" /&gt;
    &lt;entry key="urn:avalon:temp" type="java.io.File" /&gt;
  &lt;/context&gt;
&lt;/type&gt;
</pre>
    </div>
  
    </div>
  
    <div class="h4">
      
      
        <h4>
          <a name="Type Model">Type Model</a>
        </h4>
      
      
    <p>
      
The Avalon Meta package provides the overal meta-info layer within which a component type descriptor is defined.  The descriptor is an immutable data object that contains a component classname, attributes, context dependencies, deployment dependencies, runtime service dependencies, service and extension publication, and associating logging channel assumptions. The full specification of the 
    <a href="http://avalon.apache.org/meta/api/org/apache/avalon/meta/info/Type.html">Type</a>
   class is provided in the package javadoc.  Type establishment is typically automated by the container by scanner jar file for xinfo descriptors (or possibly through dynamic type creation).
        
    </p>
   
    </div>
  
    </div>
  
                  
                  
                  
                  
                  
                </div>
              </div>
            </td>
          </tr>
        </table>
        <div id="footer">
          <table border="0" style="width:100%" cellpadding="4" cellspacing="0">
            
            <tr>
              <td>
                
                  
                    
                    
                      © 1997-2004, The Apache Software Foundation
                    
                  
                  
                

                
              </td>
              
            </tr>
          </table>
        </div>
      </body>
    </html>
  