<project default="jar:install" xmlns:maven="jelly:maven" xmlns:j="jelly:core" xmlns:util="jelly:util" xmlns:ant="jelly:ant">

  <ant:property name="maven.jar.manifest.extensions.add" value="false"/>

  <preGoal name="jar:jar">
    <maven:snapshot project="${pom}"/>
    <j:set var="timestamp" value="${snapshotSignature.substring(pom.artifactId.length)}"/>
    <ant:property name="merlin.timestamp" value="${timestamp}"/>
    <ant:echo file="${basedir}/snapshot.properties">
build.signature = ${snapshotSignature}
    </ant:echo>
    <j:forEach var="dep" items="${pom.dependencies}">
      <j:if test="${dep.getId() != 'junit:junit'}">
        <unzip src="${pom.getDependencyPath( dep.getId() )}" 
          dest="${maven.build.dir}/classes"/>
      </j:if>
    </j:forEach>
  </preGoal>

</project>
