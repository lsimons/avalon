<?xml version="1.0" encoding="ISO-8859-1"?>
<!DOCTYPE project [
  <!ENTITY % index SYSTEM "file:index.ent"> %index;
]>
<project default="multiproject:install" xmlns:maven="jelly:maven" xmlns:j="jelly:core" xmlns:util="jelly:util" xmlns:ant="jelly:ant">

  <!--
  ==============================================================================
  filter resources 
  ==============================================================================
  -->

  <ant:filter token="AVALON-LOGGING-LOGKIT-SPEC" 
      value="&avalon-logging-logkit-artifact-spec;"/>
  <ant:filter token="MERLIN_IMPLEMENTATION" 
      value="artifact:merlin/merlin-impl#&merlin-impl-version;"/>
  <ant:filter token="LOGGING_IMPLEMENTATION" 
      value="&avalon-logging-logkit-artifact;"/>
  <ant:filter token="STANDARD_RUNTIME" 
      value="&avalon-activation-artifact;"/>
  <ant:filter token="REPOSITORY_MAIN" 
      value="&avalon-repository-artifact;"/>

  <postGoal name="java:compile">

    <util:file var="merlinProperties" name="merlin.properties"/>
    <j:if test="${merlinProperties.exists()}">
      <ant:copy 
          file="merlin.properties" 
          toDir="${maven.build.dir}/classes" 
          verbose="yes"
          filtering="on">
        <filterset>
          <filter token="MERLIN_IMPLEMENTATION" value="&merlin-impl-artifact;"/>
          <filter token="LOGGING_IMPLEMENTATION" value="&avalon-logging-logkit-artifact;"/>
          <filter token="STANDARD_RUNTIME" value="&avalon-activation-artifact;"/>
        </filterset>
      </ant:copy>
    </j:if>
  </postGoal>

</project>
