<project default="site" xmlns:maven="jelly:maven" xmlns:j="jelly:core" xmlns:util="jelly:util"   xmlns:ant="jelly:ant">

  <preGoal name="site">
    <attainGoal name="xavalon:css-copy"/>
    <attainGoal name="license"/>
    <attainGoal name="xjavadoc"/>
  </preGoal>

  <goal name="xavalon:css-copy">
    <ant:mkdir dir="${maven.build.dir}/docs/style"/>
    <ant:copy toDir="${maven.build.dir}/docs/style">
      <fileset dir="${basedir}/src/etc">
        <include name="maven.css"/>
        <include name="tigris.css"/>
      </fileset>
    </ant:copy>
  </goal>

  <goal name="xjavadoc">
    <mkdir dir="${basedir}/target/docs/api" />
    <property name="copyright"
      value="Copyright &amp;copy; ${year} ${pom.organization.name}. All Rights Reserved." />
    <property name="title" value="${pom.name} ${pom.currentVersion} API"/>
    <javadoc destdir="${basedir}/target/docs/api" 
	doctitle="&lt;h1&gt;Cornerstone API&lt;/h1&gt;" 
      noindex="false" author="true" use="true"
	windowtitle="${title}" 
      bottom="${copyright}"
      additionalparam="-breakiterator -J-Xmx128m "
      packagenames="*,org.*">
        <j:forEach var="packageGroup" items="${pom.packageGroups}">
      	  <group title="${packageGroup.title}" packages="${packageGroup.packages}"/>
        </j:forEach>
        <sourcepath path="${basedir}/../threads-api/src/java"/>
        <sourcepath path="${basedir}/../threads-impl/src/java"/>
        <sourcepath path="${basedir}/../connection-api/src/java"/>
        <sourcepath path="${basedir}/../connection-impl/src/java"/>
        <sourcepath path="${basedir}/../datasources-api/src/java"/>
        <sourcepath path="${basedir}/../datasources-impl/src/java"/>
        <sourcepath path="${basedir}/../sockets-api/src/java"/>
        <sourcepath path="${basedir}/../sockets-impl/src/java"/>
        <sourcepath path="${basedir}/../store-api/src/java"/>
        <sourcepath path="${basedir}/../store-impl/src/java"/>
        <classpath>
          <path refid="maven.dependency.classpath"/>
	  </classpath>
	  <link href="${sun.j2se.link}" />
	  <link href="${avalon.logkit.link}" />
	  <link href="${avalon.framework.link}" />
	  <link href="${excalibur.thread.link}" />
	  <link href="${excalibur.event.link}" />
    </javadoc>
  </goal>

</project>
