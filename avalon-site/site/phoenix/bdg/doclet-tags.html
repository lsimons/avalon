<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<META http-equiv="Content-Type" content="text/html; charset=UTF-8">
<!--*** This is a generated file.  Do not edit.  ***-->
<link rel="stylesheet" href="../skin/tigris.css" type="text/css">
<link rel="stylesheet" href="../skin/mysite.css" type="text/css">
<link rel="stylesheet" href="../skin/site.css" type="text/css">
<link media="print" rel="stylesheet" href="../skin/print.css" type="text/css">
<title>Using Doclet Tags to Generate .xinfo files</title>
</head>
<body bgcolor="white" class="composite">
<!--================= start Banner ==================-->
<div id="banner">
<table width="100%" cellpadding="8" cellspacing="0" summary="banner" border="0">
<tbody>
<tr>
<!--================= start Group Logo ==================-->
<td align="left">
<div class="groupLogo">
<a href="http://avalon.apache.org/"><img border="0" class="logoImage" alt="Apache Avalon-Phoenix" src="../images/apache-avalon-logo.png"></a>
</div>
</td>
<!--================= end Group Logo ==================-->
<!--================= start Project Logo ==================--><td align="right">
<div class="projectLogo">
<a href="http://apachecon.com/2003/US/index.html"><img border="0" class="logoImage" alt="Visit ApacheCon 2003!" src="http://www.apache.org/~ceki/ac2003/ac2003-150.gif"></a>
</div>
</td>
<!--================= end Project Logo ==================-->
</tr>
</tbody>
</table>
</div>
<!--================= end Banner ==================-->
<!--================= start Main ==================-->
<table width="100%" cellpadding="0" cellspacing="0" border="0" summary="nav" id="breadcrumbs">
<tbody>
<!--================= start Status ==================-->
<tr class="status">
<td>
<!--================= start BreadCrumb ==================--><a href="http://www.apache.org/">Apache Main</a> | <a href="http://avalon.apache.org/">Avalon Main</a> | <a href="../">Up</a>
<!--================= end BreadCrumb ==================--></td><td id="tabs">
<!--================= start Tabs ==================-->
<div class="tab">
<span class="unselectedTab"><a href="http://www.apache.org/">Apache</a></span> | <span class="unselectedTab"><a href="http://avalon.apache.org/">Avalon</a></span> | <span class="unselectedTab"><a href="http://avalon.apache.org/product/framework/">Framework</a></span> | <span class="unselectedTab"><a href="http://avalon.apache.org/product/containers/">Containers</a></span> | <span class="unselectedTab"><a href="http://avalon.apache.org/product/components/">Components</a></span>
</div>
<!--================= end Tabs ==================-->
</td>
</tr>
</tbody>
</table>
<!--================= end Status ==================-->
<table id="main" width="100%" cellpadding="8" cellspacing="0" summary="" border="0">
<tbody>
<tr valign="top">
<!--================= start Menu ==================-->
<td id="leftcol">
<div id="navcolumn">
<div class="menuBar">
<div class="menu">
<span class="menuLabel">Essentials</span>

<div class="menuItem">
<a href="../index.html">Overview</a>
</div>

<div class="menuItem">
<a href="../features.html">Features</a>
</div>

<div class="menuItem">
<a href="../getting-started.html">Getting started</a>
</div>

<div class="menuItem">
<a href="http://avalon.apache.org/bindownload.cgi">Download</a>
</div>

<div class="menuItem">
<a href="../install.html">Install</a>
</div>

</div>
<div class="menu">
<span class="menuLabel">Guide</span>

<div class="menuItem">
<a href="../guide-architecture.html">Architectural Overview</a>
</div>

<div class="menuItem">
<a href="../guide-roles.html">Development Roles</a>
</div>

<div class="menuItem">
<a href="../guide-administrator.html">for Administrators</a>
</div>

<div class="menuItem">
<a href="../guide-deployers.html">for Deployers</a>
</div>

<div class="menuItem">
<a href="../assemblers/index.html">for Assemblers</a>
</div>

<div class="menuItem">
<a href="../bdg/index.html">for Block Developers</a>
</div>

<div class="menuItem">
<a href="../mx/index.html">Management Guide</a>
</div>

<div class="menuItem">
<a href="../guide-example-configuration.html">Example configuration</a>
</div>

<div class="menuItem">
<a href="../guide-punit.html">PUnit unit testing</a>
</div>

</div>
<div class="menu">
<span class="menuLabel">Reference</span>

<div class="menuItem">
<a href="../api/index.html">API Docs</a>
</div>

<div class="menuItem">
<a href="../assemblers/config-xml-specification.html">config.xml Specification</a>
</div>

<div class="menuItem">
<a href="../assemblers/assembly-xml-specification.html">assembly.xml Specification</a>
</div>

<div class="menuItem">
<a href="../assemblers/environment-xml-specification.html">environment.xml Specification</a>
</div>

<div class="menuItem">
<a href="../bdg/blockinfo-specification.html">BlockInfo Specification</a>
</div>

</div>
<div class="menu">
<span class="menuLabel">For Developers</span>

<div class="menuItem">
<a href="../changes.html">Changes</a>
</div>

<div class="menuItem">
<a href="http://avalon.apache.org/code-standards.html">Coding standards</a>
</div>

<div class="menuItem">
<a href="../for-developers-project-structure.html">Project Structure</a>
</div>

<div class="menuItem">
<a href="http://jakarta.apache.org/site/cvsindex.html">CVS Repositories</a>
</div>

<div class="menuItem">
<a href="http://jakarta.apache.org/site/mail.html">Mailing Lists</a>
</div>

<div class="menuItem">
<a href="http://nagoya.apache.org/bugzilla/buglist.cgi?bug_status=UNCONFIRMED&bug_status=NEW&bug_status=ASSIGNED&bug_status=REOPENED&bug_status=RESOLVED&product=Avalon&component=Phoenix">TODO</a>
</div>

<div class="menuItem">
<a href="http://jira.werken.com/secure/BrowseProject.jspa?id=10081">Issue Tracker (Bug and Enhancement List)</a>
</div>

<div class="menuItem">
<a href="../for-developers-alternate-kernel.html">Alternate Kernels</a>
</div>

</div>
</div>
</div>
</td>
<!--================= end Menu ==================-->
<!--================= start Content ==================--><td>
<div id="bodycol">
<div class="app">
<div align="center">
<h1>Using Doclet Tags to Generate .xinfo files</h1>
</div>
<div class="h3">
  
  
    
<div class="h3">
<h3>Introduction</h3>
</div>
      
<p>
        Each block requires a corresponding .xinfo file that is read by the
        container at startup.  As the developer, you have the option of using
        custom java doc tags to generate the .xinfo file.  This has a number of
        advantages over generating the file by hand:
      </p>
      
<ul>
        
<li>
          its a lot faster than writing the xinfo file by hand
        </li>
        
<li>
          its harder to make mistakes, since much of the data required for the 
          xinfo file is parsed out of the source code
        </li>
      
</ul>
      
<p>
        Using this feature requires that you markup the source code with the 
        appropriate tags and then have the build script include the
        <span class="codefrag">MetaGenerateTask</span> task.  Both these steps are described
        below.
       </p>
    
    
<div class="h3">
<h3>The Tags</h3>
</div>
      
<p>
        The following tags are defined:
      </p>
      
<div class="h4">
<h4>phoenix:block</h4>
</div>
        
<table class="ForrestTable" cellspacing="1" cellpadding="4">
          
<tr class="b">
            
<td colspan="1" rowspan="1">Scope</td>
            <td colspan="1" rowspan="1">
              Applies to any class that is also a block.
            </td>
          
</tr>
          
<tr class="a">
            
<td colspan="1" rowspan="1">Purpose</td>
            <td colspan="1" rowspan="1">
              Marks the class as block and tells the MetaGenerateTask to generate
              an xinfo file for it. 
            </td>
          
</tr>
          
<tr class="b">
            
<td colspan="1" rowspan="1">Parameters</td>
            <td colspan="1" rowspan="1">
              None.
            </td>
          
</tr>
          
<tr class="a">
            
<td colspan="1" rowspan="1">Notes</td>
            <td colspan="1" rowspan="1">
            </td>
          
</tr>
        
</table>
        
<p>
          Example:
        </p>
        
<pre class="code">
/**
 * Ftp server starting point. Avalon framework will load this
 * from the jar file. This is also the starting point of remote
 * admin.
 *
 * @phoenix:block
 * @phoenix:service name="org.apache.avalon.ftpserver.interfaces.FtpServerInterface"
 *
 */
        </pre>
      
      
<div class="h4">
<h4>phoenix:service</h4>
</div>
        
<table class="ForrestTable" cellspacing="1" cellpadding="4">
          
<tr class="b">
            
<td colspan="1" rowspan="1">Scope</td>
            <td colspan="1" rowspan="1">
              Applies to classes that are also blocks and export services..
            </td>
          
</tr>
          
<tr class="a">
            
<td colspan="1" rowspan="1">Purpose</td>
            <td colspan="1" rowspan="1">
              Identifies a service that is implemented by the block.  A class
              can implement more than one service, in which case there will be
              multiple phoenix:service tags.
            </td>
          
</tr>
          
<tr class="b">
            
<td colspan="1" rowspan="1">Parameters</td>
            <td colspan="1" rowspan="1">
              Attribute "name" that is the full class name
              of the interface that defines the service.
            </td>
          
</tr>
          
<tr class="a">
            
<td colspan="1" rowspan="1">Notes</td>
            <td colspan="1" rowspan="1">
              version tag should also be supported?.
              The block must implement the interface for service it declares.
            </td>
          
</tr>
        
</table>
        
<p>
          Example: see above
        </p>
      
      
<div class="h4">
<h4>phoenix:mx</h4>
</div>
        
<table class="ForrestTable" cellspacing="1" cellpadding="4">
          
<tr class="b">
            
<td colspan="1" rowspan="1">Scope</td>
            <td colspan="1" rowspan="1">
              Classes that are also blocks.
            </td>
          
</tr>
          
<tr class="a">
            
<td colspan="1" rowspan="1">Purpose</td>
            <td colspan="1" rowspan="1">
              Indicates the full name of an interface that defines management methods for this block.
            </td>
          
</tr>
          
<tr class="b">
            
<td colspan="1" rowspan="1">Parameters</td>
            <td colspan="1" rowspan="1">
              Attribute "name" that is the full class name
              of the interface that defines the management methods.
            </td>
          
</tr>
          
<tr class="a">
            
<td colspan="1" rowspan="1">Notes</td>
            <td colspan="1" rowspan="1">
            </td>
          
</tr>
        
</table>
        
<p>
          Example:
        </p>
        
<pre class="code">
/**
 * @phoenix:block
 * @phoenix:mx name="org.apache.avalon.apps.demos.helloworldserver.HelloWorldServerMBean"
 */
        </pre>
      
      
<div class="h4">
<h4>phoenix:dependency</h4>
</div>
        
<table class="ForrestTable" cellspacing="1" cellpadding="4">
          
<tr class="b">
            
<td colspan="1" rowspan="1">Scope</td>
            <td colspan="1" rowspan="1">
              Applies to the service() method of the block.
            </td>
          
</tr>
          
<tr class="a">
            
<td colspan="1" rowspan="1">Purpose</td>
            <td colspan="1" rowspan="1">
              Identifies a dependency of this block on an another service.
            </td>
          
</tr>
          
<tr class="b">
            
<td colspan="1" rowspan="1">Parameters</td>
            <td colspan="1" rowspan="1">
              Attribute "name" that is the name of the required service.
            </td>
          
</tr>
          
<tr class="a">
            
<td colspan="1" rowspan="1">Notes</td>
            <td colspan="1" rowspan="1">
              Can also specify a required version number?  Optional dependencies?         
            </td>
          
</tr>
        
</table>
        
<p>
          Example:
        </p>
        
<pre class="code">
    /*
     * @phoenix:dependency name="org.apache.avalon.cornerstone.services.sockets.SocketManager"
     * @phoenix:dependency name="org.apache.avalon.cornerstone.services.connection.ConnectionManager"
     * @phoenix:dependency name="org.apache.avalon.ftpserver.usermanager.UserManagerInterface"
     * @phoenix:dependency name="org.apache.avalon.ftpserver.ip.IpRestrictorInterface"
     */
    public void service(ServiceManager serviceManager) throws ServiceException {
        </pre>
      
     
    
<div class="h3">
<h3>Build Instructions</h3>
</div>
      
<p>
        To have xinfo files generated as part as your ant build
        script, include the MetaGenerateTask like this:
      </p>
      
<pre class="code">

    &lt;!-- Make .xinfo, .mxinfo and manifest automatically for blocks --&gt;
    &lt;target name="metagenerate"&gt;

        &lt;taskdef name="generatemeta" classname="org.apache.avalon.phoenix.tools.metagenerate.MetaGenerateTask"&gt;
          &lt;classpath refid="project.class.path" /&gt;
        &lt;/taskdef&gt;

        &lt;generatemeta dest="${build.metagenerate}"&gt;
          &lt;fileset dir="${java.dir}"&gt;
            &lt;include name="**/*.java"/&gt;
          &lt;/fileset&gt;
        &lt;/generatemeta&gt;

    &lt;/target&gt;
 
      </pre>
      
<p>
        Where build.metagenerate is where the .xinfo files should be placed, and java.dir
        is the location of the source files.  Typically the build.metagenerate directory
        is an intermediate build directory.  Output from this task are then copied
        to a release image directory and jar'ed as a subsequent step. 
      </p>
      
<p>
        The qdox jar and phoenix-client.jar need to be in the project.class.path.
      </p>
    
  

<div id="authors" align="right">by&nbsp;Huw Roberts</div>
</div>
</div>
</div>
</td>
<!--================= end Content ==================-->
</tr>
</tbody>
</table>
<!--================= end Main ==================-->
<!--================= start Footer ==================-->
<div id="footer">
<table summary="footer" cellspacing="0" cellpadding="4" width="100%" border="0">
<tbody>
<tr>
<!--================= start Copyright ==================-->
<td colspan="2">
<div align="center">
<div class="copyright">
              Copyright &copy; 2002-2003&nbsp;The Apache Software Foundation.. All rights reserved.
            </div>
</div>
</td>
<!--================= end Copyright ==================-->
</tr>
<tr>
<td align="left">
<!--================= start Host ==================-->
<!--================= end Host ==================--></td><td align="right">
<!--================= start Credits ==================-->
<div align="right">
<div class="credit"></div>
</div>
<!--================= end Credits ==================-->
</td>
</tr>
</tbody>
</table>
</div>
<!--================= end Footer ==================-->
</body>
</html>
