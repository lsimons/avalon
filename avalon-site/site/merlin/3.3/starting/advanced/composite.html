
  

  
  

  
  

  

  
  

  
  

  
  

  

  

  

  

  

  
  
  
  
      
  

      
      
      
      
      
      
        
         
      
      

      
      
      
      

      
      
      

      

  
  

  
  

   
   


    
	
	

    
    
      
	
	
	<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

    <html>
      <head>
        
        
          <title>
            Merlin - 
          
        
          </title>
        
        
        
        <style type="text/css">
          @import url("../../style/tigris.css");
          @import url("../../style/maven.css");
        </style>
        
        
        
        
        
        <link rel="stylesheet" href="../../style/print.css" type="text/css" media="print"></link>
        <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1"></meta>
        
        
        
        
      </head>

      <body class="composite">

        <div id="banner">
          <table height="103" border="0" width="100%" cellpadding="8" cellspacing="0">
            <tr>
              
              <td>
                
                
                  
                  
                  
                    
                  
                  
                  
                  
                  
                  <a href="http://avalon.apache.org/">
                    <img border="0" alt="The Apache Software Foundation" src="http://avalon.apache.org/images/apache-avalon-logo.png" align="left"></img>
                  </a>
                
              </td>

              <td></td>
              

            </tr>
          </table>
        </div>
        <div id="breadcrumbs">
          <table border="0" width="100%" cellpadding="4" cellspacing="0">
            <tr>
              
              <td>
                <div align="right">
                  
                  
                  
                    
    
    
      
      
      
      <a href="http://apache.org/">Apache</a>
      
    
      |
      
      
      <a href="http://avalon.apache.org/">Avalon</a>
      
    
      |
      
      
      <a href="http://avalon.apache.org/product/framework/">Framework</a>
      
    
      |
      
      
      <a href="http://avalon.apache.org/product/containers/">Containment</a>
      
    
      |
      
      
      <a href="http://avalon.apache.org/product/components/">Components</a>
      
    
  
                  
                  
                </div>
              </td>
            </tr>
          </table>
        </div>
        
        <table border="0" width="100%" cellpadding="8" cellspacing="0"> 
          <tr valign="top">
            <td width="20%" id="leftcol">
              <div id="navcolumn">
                

                
                  
    <div>
      <strong>About Merlin</strong>
      
    
    
    
    

    <div>
      <small>
      	
      	
      		<a href="../../about/index.html">Overview</a>
      	
      </small>
	  
        
      
    </div>
  
    
    
    
    

    <div>
      <small>
      	
      	
      		<a href="../../starting/index.html">Getting Started</a>
      	
      </small>
	  
        
    
    
    
    

    <div>
      <small>
      	
      	
      		<a href="../../starting/installation/index.html">Installation</a>
      	
      </small>
	  
        
      
    </div>
  
    
    
    
    

    <div>
      <small>
      	
      	
      		<a href="../../starting/tutorial/index.html">Using Merlin</a>
      	
      </small>
	  
        
      
    </div>
  
    
    
    
    

    <div>
      <small>
      	
      	
      		<a href="../../starting/advanced/index.html">Advanced Features</a>
      	
      </small>
	  
        
    
    
    
    

    <div>
      <small>
      	
      	
      		<a href="../../starting/advanced/lifecycle/index.html">Lifecycle Tools</a>
      	
      </small>
	  
        
      
    </div>
  
    
    
    
    

    <div>
      <small>
      	
      	
      		<a href="../../starting/advanced/context.html">Contextualization</a>
      	
      </small>
	  
        
      
    </div>
  
    
    
    
    

    <div>
      <small>
      	
      	
      		<a href="../../starting/advanced/profiles.html">Deployment Templates</a>
      	
      </small>
	  
        
      
    </div>
  
    
    
    
    

    <div>
      <small>
      	
      	
      		<a href="../../starting/advanced/selection.html">Profile Selection</a>
      	
      </small>
	  
        
      
    </div>
  
    
    
    
    

    <div>
      <small>
      	
      		<b><a href="../../starting/advanced/composite.html">Composition</a></b>
      	
      	
      </small>
	  
        
      
    </div>
  
    
    
    
    

    <div>
      <small>
      	
      	
      		<a href="../../starting/advanced/unit/index.html">Unit Test</a>
      	
      </small>
	  
        
      
    </div>
  
      
    </div>
  
      
    </div>
  
    
    
    
    

    <div>
      <small>
      	
      	
      		<a href="../../merlin/index.html">Merlin System</a>
      	
      </small>
	  
        
      
    </div>
  
    
    
    
    

    <div>
      <small>
      	
      	
      		<a href="../../extensions/index.html">Extensions</a>
      	
      </small>
	  
        
      
    </div>
  
    
    
    
    

    <div>
      <small>
      	
      	
      		<a href="../../tools/index.html">Tools</a>
      	
      </small>
	  
        
      
    </div>
  
    </div>
  
    <div>
      <strong>Resources</strong>
      
    
    
    
    

    <div>
      <small>
      	
      	
      		<a href="../../api/index.html">Javadoc</a>
      	
      </small>
	  
        
      
    </div>
  
    
    
    
    

    <div>
      <small>
      	
      	
      		<a href="../../reference/index.html">Specification</a>
      	
      </small>
	  
        
      
    </div>
  
    
    
    
    

    <div>
      <small>
      	
      	
      		<a href="../../resources/download.html">Download</a>
      	
      </small>
	  
        
      
    </div>
  
    
    
    
    

    <div>
      <small>
      	
      	
      		<a href="../../resources/roadmap/index.html">Roadmap</a>
      	
      </small>
	  
        
      
    </div>
  
    
    
    
    

    <div>
      <small>
      	
      	
      		<a href="../../dpml/index.html">DPML</a>
      	
      </small>
	  
        
      
    </div>
  
    </div>
  
    <div>
      <strong>Related Projects</strong>
      
    
    
    
    

    <div>
      <small>
      	
      	
      		<a href="http://avalon.apache.org/meta">Meta</a>
      	
      </small>
	  
        
      
    </div>
  
    
    
    
    

    <div>
      <small>
      	
      	
      		<a href="http://avalon.apache.org/util">Utilities</a>
      	
      </small>
	  
        
      
    </div>
  
    
    
    
    

    <div>
      <small>
      	
      	
      		<a href="http://avalon.apache.org/repository">Repository</a>
      	
      </small>
	  
        
      
    </div>
  
    </div>
  
                
                
                
                

                
                
                <div>
                  <strong>Project Documentation</strong>
                  
                  <div>
                    <small>
                      <a href="../../project-info.html">Project Info</a>
                    </small>
                    
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                  </div>
                  <div>
                    <small>
                      <a href="../../maven-reports.html">Project Reports</a>
                    </small>
                    
					
                    
                    
                      
                      
                    
                      
                      
                    
                    
                    
                    
                  </div>
                  
                    
                  
                  
                </div>
              
              
                
                
                
                
              
                
              </div>
            </td>
            <td rowspan="2">
              <div id="bodycol">
                
                <div class="app">
                  
                  
    <div class="h3">
      
      
        <h3>
          <a name="Advanced Features">Advanced Features</a>
        </h3>
      
      
    <div class="h4">
      
      
        <h4>
          <a name="Composite Blocks">Composite Blocks</a>
        </h4>
      
      
    <p>
      
         A container can declare services that it exports.  In such a case
         the container declares one or more service directives that map 
         components declared within itself as service providers.  
         This mechanism enables a container to appear as a regular 
         component relative to other components.
        
    </p>
   
    <p>
      
         Content supporting this tutorial is available under the 
         tutorials/composition directory.
        
    </p>
   
    </div>
  
    <div class="h4">
      
      
        <h4>
          <a name="Sample Container">Sample Container</a>
        </h4>
      
      
    <p>
      
         The following container definition includes:
        
    </p>
   
    <ul>
      
          
    <li>
      
    <p>
      an application component
    </p>
   
    </li>
   
          
    <li>
      
    <p>
      a location provider block included by reference
    </p>
   
    </li>
   
          
    <li>
      
    <p>
      an application block included by reference
    </p>
   
    </li>
   
        
    </ul>
   
    <p>
      
          The application block declares dependencies on a location 
          and publishing service.  The location and publishing block
          declare that they provide these respective services. As a part of 
          the general component assembly process - Merlin will assemble 
          blocks relative to the services and dependencies they declare.
          When a block is deployed, it appears to other components as a 
          component providing the services it exports.  However in practice
          these services are provided by components defined within the 
          container (i.e. the container represents the definition of 
          a virtual component and the containers components and subcontainers
          represent the virtual component implementation).
        
    </p>
   
    <p>
      The top level application block declaration (block.xml):
    </p>
   
    <div id="source">
      <pre>
&lt;container name="application"&gt;

     &lt;classloader&gt;
       &lt;classpath&gt;
         &lt;repository&gt;
           &lt;resource id="avalon-framework:avalon-framework-impl" version="4.1.5"/&gt;
           &lt;resource id="merlin-tutorial:locator-api" version="1.0"/&gt;
           &lt;resource id="merlin-tutorial:publisher-api" version="1.0"/&gt;
           &lt;resource id="merlin-tutorial:application-impl" version="1.0"/&gt;
         &lt;/repository&gt;
       &lt;/classpath&gt;
     &lt;/classloader&gt;

     &lt;!-- 
     note: each of the following include directives is equivalent to 
     a nested container declaration - using include or declaraing a 
     sub-container is semantically equivalent
     --&gt;

     &lt;include name="location" id="merlin-tutorial:locator-impl" version="1.0"/&gt;
     &lt;include name="publisher" id="merlin-tutorial:publisher-impl" version="1.0"/&gt;

     &lt;component name="application" 
        class="tutorial.application.Application"&gt;
     &lt;/component&gt;

&lt;/container&gt;
</pre>
    </div>
  
    <p>
      
          If we look at the location block (as an example) we will see a corresponding
          service declaration.  This declaration includes a source reference that is 
          a relative component path that tells Merlin to use the sub-component named
          "location" as the component that will fulfil the service published by this 
          block.
        
    </p>
   
    <div id="source">
      <pre>
&lt;container name="locator"&gt;

   &lt;services&gt;
     &lt;service type="tutorial.location.LocationService"&gt;
       &lt;source&gt;info&lt;/source&gt;
     &lt;/service&gt;
   &lt;/services&gt;

   &lt;classloader&gt;
     &lt;classpath&gt;
       &lt;repository&gt;
         &lt;resource id="avalon-framework:avalon-framework-api" version="SNAPSHOT"/&gt;
         &lt;resource id="avalon-framework:avalon-framework-impl" version="SNAPSHOT"/&gt;
         &lt;resource id="merlin-tutorial:locator-api" version="1.0"/&gt;
         &lt;resource id="merlin-tutorial:locator-impl" version="1.0"/&gt;
       &lt;/repository&gt;
     &lt;/classpath&gt;
   &lt;/classloader&gt;

   &lt;component name="info" 
       class="tutorial.location.LocationComponent"&gt;
       &lt;configuration&gt;
         &lt;source&gt;Paris&lt;/source&gt;
       &lt;/configuration&gt;
   &lt;/component&gt;

&lt;/container&gt;
</pre>
    </div>
  
    </div>
  
    <div class="h4">
      
      
        <h4>
          <a name="Execution">Execution</a>
        </h4>
      
      
    <p>
      
         To run build and run the example please use the following commands:
        
    </p>
   
    <div id="source">
      <pre>
$ cd application/impl
$ maven build
$ merlin target\*.jar -repository %MAVEN_HOME% -execute
</pre>
    </div>
  
    <p>
      
         The log output demonstrates the deployment by Merlin of the blocks
         in the correct order (based on dependency resolution) and the 
         execution of the test application.
        
    </p>
   
    <div id="source">
      <pre>
[INFO   ] (application.publisher.publisher): created
[INFO   ] (application.location.info): location: Paris
[INFO   ] (application.application): servicing application
[INFO   ] (application.location.info): location: Paris
[INFO   ] (application.publisher.publisher): created
[INFO   ] (application.publisher.publisher):
******************
* Paris
******************
[INFO   ] (application.application): done
</pre>
    </div>
  
    </div>
  
    <div class="h4">
      
      
        <h4>
          <a name="Note">Note</a>
        </h4>
      
      
    <p>
      
         The primary benefit of using block level services and dependencies
         is isolation of a block implementation from the public services it 
         provides.
        
    </p>
   
    </div>
  
    </div>
  
                  
                  
                  
                  
                  
                </div>
              </div>
            </td>
          </tr>
        </table>
        <div id="footer">
          <table border="0" style="width:100%" cellpadding="4" cellspacing="0">
            
            <tr>
              <td>
                
                  
                    
                    
                      © 1997-2004, The Apache Software Foundation
                    
                  
                  
                

                
              </td>
              
            </tr>
          </table>
        </div>
      </body>
    </html>
  