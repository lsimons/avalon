
  

  
  

  
  

  

  
  

  
  

  
  

  

  

  

  

  

  
  
  
  
      
  

      
      
      
      
      
      
        
         
      
      

      
      
      
      

      
      
      

      

  
  

  
  

   
   


    
	
	

    
    
      
	
	
	<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

    <html>
      <head>
        
        
          <title>
            Merlin - 
          
        
          </title>
        
        
        
        <style type="text/css">
          @import url("../../style/tigris.css");
          @import url("../../style/maven.css");
        </style>
        
        
        
        
        
        <link rel="stylesheet" href="../../style/print.css" type="text/css" media="print"></link>
        <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1"></meta>
        
        
        
        
      </head>

      <body class="composite">

        <div id="banner">
          <table height="103" border="0" width="100%" cellpadding="8" cellspacing="0">
            <tr>
              
              <td>
                
                
                  
                  
                  
                    
                  
                  
                  
                  
                  
                  <a href="http://avalon.apache.org/">
                    <img border="0" alt="The Apache Software Foundation" src="http://avalon.apache.org/images/apache-avalon-logo.png" align="left"></img>
                  </a>
                
              </td>

              <td></td>
              

            </tr>
          </table>
        </div>
        <div id="breadcrumbs">
          <table border="0" width="100%" cellpadding="4" cellspacing="0">
            <tr>
              
              <td>
                <div align="right">
                  
                  
                  
                    
    
    
      
      
      
      <a href="http://apache.org/">Apache</a>
      
    
      |
      
      
      <a href="http://avalon.apache.org/">Avalon</a>
      
    
      |
      
      
      <a href="http://avalon.apache.org/product/framework/">Framework</a>
      
    
      |
      
      
      <a href="http://avalon.apache.org/product/containers/">Containment</a>
      
    
      |
      
      
      <a href="http://avalon.apache.org/product/components/">Components</a>
      
    
  
                  
                  
                </div>
              </td>
            </tr>
          </table>
        </div>
        
        <table border="0" width="100%" cellpadding="8" cellspacing="0"> 
          <tr valign="top">
            <td width="20%" id="leftcol">
              <div id="navcolumn">
                

                
                  
    <div>
      <strong>About Merlin</strong>
      
    
    
    
    

    <div>
      <small>
      	
      	
      		<a href="../../about/index.html">Overview</a>
      	
      </small>
	  
        
      
    </div>
  
    
    
    
    

    <div>
      <small>
      	
      	
      		<a href="../../starting/index.html">Getting Started</a>
      	
      </small>
	  
        
    
    
    
    

    <div>
      <small>
      	
      	
      		<a href="../../starting/installation/index.html">Installation</a>
      	
      </small>
	  
        
      
    </div>
  
    
    
    
    

    <div>
      <small>
      	
      	
      		<a href="../../starting/tutorial/index.html">Using Merlin</a>
      	
      </small>
	  
        
    
    
    
    

    <div>
      <small>
      	
      		<b><a href="../../starting/tutorial/creation.html">Hello Block</a></b>
      	
      	
      </small>
	  
        
      
    </div>
  
    
    
    
    

    <div>
      <small>
      	
      	
      		<a href="../../starting/tutorial/execution.html">Running Hello</a>
      	
      </small>
	  
        
      
    </div>
  
    
    
    
    

    <div>
      <small>
      	
      	
      		<a href="../../starting/tutorial/internal.html">Behind the Scenes</a>
      	
      </small>
	  
        
      
    </div>
  
    
    
    
    

    <div>
      <small>
      	
      	
      		<a href="../../starting/tutorial/config/index.html">Configurations</a>
      	
      </small>
	  
        
      
    </div>
  
    
    
    
    

    <div>
      <small>
      	
      	
      		<a href="../../starting/tutorial/context/index.html">Contextualization</a>
      	
      </small>
	  
        
      
    </div>
  
    
    
    
    

    <div>
      <small>
      	
      	
      		<a href="../../starting/tutorial/services.html">Services</a>
      	
      </small>
	  
        
      
    </div>
  
    
    
    
    

    <div>
      <small>
      	
      	
      		<a href="../../starting/tutorial/dependencies/index.html">Dependencies</a>
      	
      </small>
	  
        
      
    </div>
  
      
    </div>
  
    
    
    
    

    <div>
      <small>
      	
      	
      		<a href="../../starting/advanced/index.html">Advanced Features</a>
      	
      </small>
	  
        
      
    </div>
  
      
    </div>
  
    
    
    
    

    <div>
      <small>
      	
      	
      		<a href="../../merlin/index.html">Merlin System</a>
      	
      </small>
	  
        
      
    </div>
  
    
    
    
    

    <div>
      <small>
      	
      	
      		<a href="../../extensions/index.html">Extensions</a>
      	
      </small>
	  
        
      
    </div>
  
    
    
    
    

    <div>
      <small>
      	
      	
      		<a href="../../tools/index.html">Tools</a>
      	
      </small>
	  
        
      
    </div>
  
    </div>
  
    <div>
      <strong>Resources</strong>
      
    
    
    
    

    <div>
      <small>
      	
      	
      		<a href="../../api/index.html">Javadoc</a>
      	
      </small>
	  
        
      
    </div>
  
    
    
    
    

    <div>
      <small>
      	
      	
      		<a href="../../reference/index.html">Specification</a>
      	
      </small>
	  
        
      
    </div>
  
    
    
    
    

    <div>
      <small>
      	
      	
      		<a href="../../resources/download.html">Download</a>
      	
      </small>
	  
        
      
    </div>
  
    
    
    
    

    <div>
      <small>
      	
      	
      		<a href="../../resources/roadmap/index.html">Roadmap</a>
      	
      </small>
	  
        
      
    </div>
  
    
    
    
    

    <div>
      <small>
      	
      	
      		<a href="../../dpml/index.html">DPML</a>
      	
      </small>
	  
        
      
    </div>
  
    </div>
  
    <div>
      <strong>Related Projects</strong>
      
    
    
    
    

    <div>
      <small>
      	
      	
      		<a href="http://avalon.apache.org/meta">Meta</a>
      	
      </small>
	  
        
      
    </div>
  
    
    
    
    

    <div>
      <small>
      	
      	
      		<a href="http://avalon.apache.org/util">Utilities</a>
      	
      </small>
	  
        
      
    </div>
  
    
    
    
    

    <div>
      <small>
      	
      	
      		<a href="http://avalon.apache.org/repository">Repository</a>
      	
      </small>
	  
        
      
    </div>
  
    </div>
  
                
                
                
                

                
                
                <div>
                  <strong>Project Documentation</strong>
                  
                  <div>
                    <small>
                      <a href="../../project-info.html">Project Info</a>
                    </small>
                    
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                  </div>
                  <div>
                    <small>
                      <a href="../../maven-reports.html">Project Reports</a>
                    </small>
                    
					
                    
                    
                      
                      
                    
                      
                      
                    
                    
                    
                    
                  </div>
                  
                    
                  
                  
                </div>
              
              
                
                
                
                
              
                
              </div>
            </td>
            <td rowspan="2">
              <div id="bodycol">
                
                <div class="app">
                  
                  
    <div class="h3">
      
      
        <h3>
          <a name="Using Merlin">Using Merlin</a>
        </h3>
      
      
    <div class="h4">
      
      
        <h4>
          <a name="Tutorial Overview">Tutorial Overview</a>
        </h4>
      
      
    <p>
      
        This tutorial takes you though the creation of a very simple
        component, the declaration of a component type descriptor, and the 
        declaration of a block containing the component.
        
    </p>
   
    <p>
      
        Resources (sample code and build files) supporting this tutorial 
        are included in the Merlin distribution under the tutorials/hello
        directory.
        
    </p>
   
    </div>
  
    <div class="h4">
      
      
        <h4>
          <a name="Creating a component">Creating a component</a>
        </h4>
      
      
    <p>
      
           The following code is a minimal component.  It simply log a 
           message during the initialization stage.  We will progressively 
           extend this component to do more creative things as we proceed 
           through this tutorial.
        
    </p>
   
    <div id="source">
      <pre>
package tutorial;

import org.apache.avalon.framework.logger.Logger;
import org.apache.avalon.framework.logger.LogEnabled;
import org.apache.avalon.framework.activity.Disposable;
import org.apache.avalon.framework.activity.Executable;
import org.apache.avalon.framework.activity.Initializable;

/**
 * A sample component.  This component implements a number 
 * of lifecycle interface.  Each lifecycle interface is a stage
 * that is processed by a container during the deployment of 
 * the component.  The lifecycle stages demonstrated here include
 * LogEnabled (association of a logging channel), Initializable
 * (initialization of the component), Executable (component
 * execution), and Disposable (componet disposal).  PLease note 
 * that all lifecycle stages are optional.
 *
 * @avalon.component version="1.0" name="hello"
 */
public class HelloComponent 
  implements LogEnabled, Initializable, Executable, Disposable
{

   /**
    * Internal reference to the logging channel supplied to us 
    * by the container. 
    */
    private Logger m_logger;

   /**
    * Supply of a logging channel by the container.
    *
    * @param logger the logging channel for this component
    */
    public void enableLogging( final Logger logger )
    {
        m_logger = logger;
        getLogger().info( "logging stage" );
    }

   /**
    * Initialization of the component by the container.
    * @exception Exception if an initialization error occurs
    */
    public void initialize() throws Exception
    {
        getLogger().info( "initialization stage" );
    }

   /**
    * Component execution trigger by the container following 
    * completion of the initialization stage.
    */
    public void execute()
    {
        getLogger().info( "execution stage" );
    } 

   /**
    * Component disposal trigger by the container during which
    * the component will release consumed resources.
    */
    public void dispose()
    {
        getLogger().info( "disposal stage" );
        m_logger = null;
    } 

   /**
    * Return the logging channel assigned to us by the container.
    * @return the logging channel
    */
    private Logger getLogger()
    {
        return m_logger;
    }

}
</pre>
    </div>
  
    </div>
  
    <div class="h4">
      
      
        <h4>
          <a name="Creating a Type Descriptor">Creating a Type Descriptor</a>
        </h4>
      
      
    <p>
      
          In order for Merlin to recognize this class as a component, we need to
          generate a &lt;classname&gt;.xinfo file. However, this can be done
          automatically by including a pre-goal as shown below into the 
          maven.xml file. 
        
    </p>
   
    <div id="source">
      <pre>
&lt;preGoal name="java:compile"&gt;
  &lt;attainGoal name="avalon:meta"/&gt;
&lt;/preGoal&gt;
</pre>
    </div>
  
    <p>
      
          The avalon:meta plugin looks for @avalon tags in the
          source code, to generate the correct Type Descriptor. In the above 
          example it will find the @avalon.component tag in the class level 
          javadocs and generate component the descriptors for us (see below). 
        
    </p>
   
    </div>
  
    <div class="h4">
      
      
        <h4>
          <a name="Generated Type Descriptor">Generated Type Descriptor</a>
        </h4>
      
      
    <p>
      
          The following text is an example of a component type definition.  
          It contains the declaration of the component name and the component 
          implementation version. From the example above 
          ( 
    <code>
      @avalon.component version="1.0" name="hello"
    </code>
    ) the
          generated Type Descriptor would look something like this.
        
    </p>
   
    <div id="source">
      <pre>
&lt;type&gt;
  &lt;info&gt;
    &lt;name&gt;hello&lt;/name&gt;
    &lt;version&gt;1.0.0&lt;/version&gt;
    &lt;lifestyle&gt;transient&lt;/lifestyle&gt;
  &lt;/info&gt;
&lt;/type&gt;
</pre>
    </div>
  
    </div>
  
    <div class="h4">
      
      
        <h4>
          <a name="Creating a block">Creating a block</a>
        </h4>
      
      
    <p>
      
          A block is the definition of a composite component. It represents an
          application made up of a set of components and the supporting 
          resources.  In our example the block will contain the single 
          HelloComponent component.  Based on this information Merlin will 
          create a container and deploy the hello component on startup.
        
    </p>
   
    <div id="source">
      <pre>
&lt;container name="tutorial"&gt;

   &lt;classloader&gt;
     &lt;classpath&gt;
       &lt;repository&gt;
         &lt;resource id="avalon-framework:avalon-framework-impl" version="4.1.5"/&gt;
       &lt;/repository&gt;
     &lt;/classpath&gt;
   &lt;/classloader&gt;

   &lt;component name="hello" class="tutorial.HelloComponent"/&gt;

&lt;/container&gt;
</pre>
    </div>
  
    </div>
  
    <div class="h4">
      
      
        <h4>
          <a name="Execution">Execution</a>
        </h4>
      
      
    <p>
      
        The next tutorial - titled 
    <a href="execution.html">Running Hello</a>
   
        covers deployment of the component using the Merlin runtime platform.
        
    </p>
   
    </div>
  
    </div>
  
                  
                  
                  
                  
                  
                </div>
              </div>
            </td>
          </tr>
        </table>
        <div id="footer">
          <table border="0" style="width:100%" cellpadding="4" cellspacing="0">
            
            <tr>
              <td>
                
                  
                    
                    
                      © 1997-2004, The Apache Software Foundation
                    
                  
                  
                

                
              </td>
              
            </tr>
          </table>
        </div>
      </body>
    </html>
  